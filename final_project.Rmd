Final Project by Wonjun Lee
========================================================

```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
# Load all of the packages that you end up using
# in your analysis in this code chunk.

# Notice that the parameter "echo" was set to FALSE for this code chunk.
# This prevents the code from displaying in the knitted HTML output.
# You should set echo=FALSE for all code chunks in your file.

library(ggplot2)
```

```{r echo=FALSE, Load_the_Data}
# Load the Data
df <- read.csv("c:/users/WONJUN/dropbox/private/study/udacity/r_project/wineQualityReds.csv")
names(df)
```

# Univariate Plots Section
```{r echo=FALSE, Univariate_Plots}
dim(df)
summary(df)
str(df)

```

There are 13 variables with 1599 observations.
Plotting a histogram for each variable will be helpful in understanding the data set.

### Fixed Acidity
```{r}
ggplot(aes(x=fixed.acidity), data=df) +
  geom_histogram()

ggplot(aes(x=fixed.acidity), data=df) +
  geom_histogram(binwidth=.1)
```

### Volatile Acidity
```{r}
ggplot(aes(x=volatile.acidity), data=df) +
  geom_histogram()
```

### Citric Acidity
```{r}
ggplot(aes(x=citric.acid), data=df) +
  geom_histogram()
```

It looks right skewed graph but more thorough analysis will be helpful.

```{r}
ggplot(aes(x=citric.acid), data=df) +
  geom_histogram(bins=100)
```

This is very intersting graph because there are huge count at 0.00 and 0.50. More analysis might reveal interesting things.

```{r}
ggplot(aes(x=citric.acid), data=df) +
  geom_histogram() +
  scale_x_log10()
```

After log10 is applied to citric acid, there are still many gabs before .10.

### Residual Sugar
```{r}
ggplot(aes(x=residual.sugar), data=df) +
  geom_histogram(bins=50)
```

The graph has many outliers after 10. Using subset, anything above 10 is excluded and graphed again.

```{r}
ggplot(aes(x=residual.sugar), data=subset(df,residual.sugar<10)) +
  geom_histogram(bins=100)
```

Still the graph is right skewed.

### Chlorides
```{r}
ggplot(aes(x=chlorides), data=df) +
  geom_histogram(bins=100)
```

This variable also has many outliers after 0.25.
Such outliers are taken out.

```{r}
ggplot(aes(x=chlorides), data=subset(df,chlorides<.25)) +
  geom_histogram(bins=100)
```

Most of the chlorides are between .05 and .10.

```{r}
#install.packages("dplyr")
library(dplyr)

dim(df)
df %>%
  filter(chlorides>.15) %>%
  summarise(n=n())
```

There are total 1599 observations and only 67 observations that are larger than .15.

### Free Sulfur Dioxide
```{r}
ggplot(aes(x=free.sulfur.dioxide), data=df) +
  geom_histogram(bins=100)
```

### Density
```{r}
ggplot(aes(x=density), data=df) +
  geom_histogram(bins=100)
```

### pH
```{r}
ggplot(aes(x=pH), data=df) +
  geom_histogram()
```

### Sulphates
```{r}
ggplot(aes(x=sulphates), data=df) +
  geom_histogram()
```

### Alcohol
```{r}
ggplot(aes(x=alcohol), data=df) +
  geom_histogram(binwidth=.1) 
```

### Quality
```{r}
ggplot(aes(x=quality), data=df) +
  geom_histogram()
```


### More graphs with density and quality
I got interested in the relationship between the density and the quality.
```{r}
ggplot(aes(x=density),data=df) +
  geom_histogram() +
  facet_wrap(~quality)
```

```{r}
table(df$quality)
```

Facet wrap shows that most of wines have qualities of 5 and 6.
The summary shows that there are not many quality of 3 and 8.
However, regardless of the quality of the wine, the density is usually .996.

```{r}
df %>%
  group_by(quality) %>%
  summarise(mean=mean(density))

str(df)
```

The means are very close to each other.


# Univariate Analysis

### What is the structure of your dataset?
There are 1599 observations and 13 variables.
```{r}
str(df)
```
Quality is the only ordered factor variable with the following levels.
```{r}
table(df$quality)
```

### What is/are the main feature(s) of interest in your dataset?
I am interested in finding which variable affects the quality the most.
Then I will find the value of each variable that defines the best quality of wines.

### What other features in the dataset do you think will help support your investigation into your feature(s) of interest?
Density is already checked and density shows the similar pattern regardless of the quality. So other variables have to be analyzed.


### Did you create any new variables from existing variables in the dataset?

### Of the features you investigated, were there any unusual distributions? Did you perform any operations on the data to tidy, adjust, or change the form of the data? If so, why did you do this?



# Bivariate Plots Section
```{r echo=FALSE, Bivariate_Plots}

```

# Bivariate Analysis

### Talk about some of the relationships you observed in this part of the investigation. How did the feature(s) of interest vary with other features in the dataset?

### Did you observe any interesting relationships between the other features (not the main feature(s) of interest)?

### What was the strongest relationship you found?




# Multivariate Plots Section

```{r echo=FALSE, Multivariate_Plots}

```

# Multivariate Analysis

### Talk about some of the relationships you observed in this part of the investigation. Were there features that strengthened each other in terms of looking at your feature(s) of interest?

### Were there any interesting or surprising interactions between features?

### OPTIONAL: Did you create any models with your dataset? Discuss the strengths and limitations of your model.

------

# Final Plots and Summary

### Plot One
```{r echo=FALSE, Plot_One}

```

### Description One


### Plot Two
```{r echo=FALSE, Plot_Two}

```

### Description Two


### Plot Three
```{r echo=FALSE, Plot_Three}

```

### Description Three

------

# Reflection
